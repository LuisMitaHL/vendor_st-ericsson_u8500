<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.4.4" />
<title>CSPSA Test Specification</title>
<style type="text/css">
/* Debug borders */
p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
/*
  border: 1px solid red;
*/
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

tt {
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  font-family: sans-serif;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}

div.sectionbody {
  font-family: serif;
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revision {
  font-family: sans-serif;
}

div#footer {
  font-family: sans-serif;
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.5em;
  margin-bottom: 2.5em;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock {
  padding-left: 2.0em;
  margin-right: 10%;
}
div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock {
  padding-left: 2.0em;
  margin-right: 10%;
}
div.verseblock > div.content {
  white-space: pre;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 2px solid silver;
}

div.exampleblock > div.content {
  border-left: 2px solid silver;
  padding: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
div.imageblock img { border: 1px solid silver; }
span.image img { border-style: none; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead {
  font-family: sans-serif;
  font-weight: bold;
}
tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

@media print {
  div#footer-badges { display: none; }
}

div#toctitle {
  color: #527bbd;
  font-family: sans-serif;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}
/* Workarounds for IE6's broken and incomplete CSS2. */

div.sidebar-content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}
div.sidebar-title, div.image-title {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  margin-top: 0.0em;
  margin-bottom: 0.5em;
}

div.listingblock div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock-attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock-content {
  white-space: pre;
}
div.verseblock-attribution {
  padding-top: 0.75em;
  text-align: left;
}

div.exampleblock-content {
  border-left: 2px solid silver;
  padding-left: 0.5em;
}

/* IE6 sets dynamically generated links as visited. */
div#toc a:visited { color: blue; }
</style>
</head>
<body>
<div id="header">
<h1>CSPSA Test Specification</h1>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>This document describes a basic set of tests for Crash Safe Parameter Storage Area (CSPSA). It can be used to verify CSPSA on
different kind of platforms and media. In for example a PC Ubuntu it is possible to
operate with an image in RAM, while in an embedded device one can operate on e.g. either MTD or MMC.</p></div>
<div class="paragraph"><p>The idea is that all test cases should be executed as a regression test before updated CSPSA code is released. Single test
cases should only be executed in case of bug hunting.</p></div>
<div class="paragraph"><p>Before starting test, the maximum size of an internal image array in CSPSA should be configured to 512 bytes.</p></div>
<div class="paragraph"><p>Note: TC = Test Case</p></div>
</div>
</div>
<h4 id="_cspsa_tc_1">CSPSA_TC_1</h4>
<h5 id="_test_objective">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Create a CSPSA image and verify it
</p>
</li>
<li>
<p>
All CSPSA function call durations should be summed up and presented as a test result
</p>
</li>
<li>
<p>
A summed duration time for each type of function call should be presented (that is separate
sums for open, flush, close, read and write operations)
</p>
</li>
</ul></div>
<h5 id="_test_steps">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Create image in different ways when it comes to keys and sizes. E.g. increasing and decreasing
  key values, increasing and decreasing size values etc.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_2">CSPSA_TC_2</h4>
<h5 id="_test_objective_2">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Delete objects in a CSPSA image and verify it
</p>
</li>
<li>
<p>
All CSPSA function call durations should be summed up and presented as a test result
</p>
</li>
</ul></div>
<h5 id="_test_steps_2">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Delete some values at beginning, end and in middle.
</p>
</li>
<li>
<p>
Update some of the values that are to be deleted so that they end up in item list.
</p>
</li>
<li>
<p>
Try to remove all items.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_3">CSPSA_TC_3</h4>
<h5 id="_test_objective_3">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Get error result if a CSPSA image cannot be written
</p>
</li>
<li>
<p>
All CSPSA function call durations should be summed up and presented as a test result
</p>
</li>
</ul></div>
<h5 id="_test_steps_3">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Try to write an image that is larger than half the storage area that is not read-only.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_4">CSPSA_TC_4</h4>
<h5 id="_test_objective_4">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Manipulate one bit in the CSPSA data field and make sure CSPSA detects it
</p>
</li>
<li>
<p>
All CSPSA function call durations should be summed up and presented as a test result
</p>
</li>
</ul></div>
<h5 id="_test_steps_4">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Manipulate one bit in data that is not a key or size field.
</p>
</li>
<li>
<p>
Manipulate one bit in data that is a key field.
</p>
</li>
<li>
<p>
Manipulate one bit in data that is a size field.
</p>
</li>
<li>
<p>
Manipulate one bit in data that is a size field.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_5">CSPSA_TC_5</h4>
<h5 id="_test_objective_5">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Manipulate one bit in one header&#8217;s CSPSA header fields (one field at a time) and make sure CSPSA detects it
</p>
</li>
<li>
<p>
All CSPSA function call durations should be summed up and presented as a test result
</p>
</li>
</ul></div>
<h5 id="_test_steps_5">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Manipulate one bit in header "Magic" field at start of storage area.
</p>
</li>
<li>
<p>
Manipulate one bit in header "Magic" field at end of storage area.
</p>
</li>
<li>
<p>
Manipulate one bit in "Version" field at start of storage area.
</p>
</li>
<li>
<p>
Manipulate one bit in "Index" field at start of storage area.
</p>
</li>
<li>
<p>
Manipulate one bit in "Index" field at end of storage area.
</p>
</li>
<li>
<p>
Manipulate one bit in "Flags" field at start of storage area.
</p>
</li>
<li>
<p>
Manipulate one "small" bit in "DataSize" field at start of storage area.
</p>
</li>
<li>
<p>
Manipulate one "large" bit in "DataSize" field at end of storage area.
</p>
</li>
<li>
<p>
Manipulate one bit in "Crc32Data" field at start of storage area.
</p>
</li>
<li>
<p>
Manipulate one bit in "Crc32Data" field at end of storage area.
</p>
</li>
<li>
<p>
Manipulate one bit in "Crc32Header" field at start of storage area.
</p>
</li>
<li>
<p>
Manipulate one bit in "Crc32Header" field at end of storage area.
</p>
</li>
<li>
<p>
Manipulate one bit in "BbtSize" field at start of storage area.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_6">CSPSA_TC_6</h4>
<h5 id="_test_objective_6">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Manipulate one bit in both header&#8217;s CSPSA header fields (one field at a time) and make sure CSPSA fails to open
</p>
</li>
<li>
<p>
All CSPSA function call durations should be summed up and presented as a test result
</p>
</li>
</ul></div>
<h5 id="_test_steps_6">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Manipulate one bit in header "DataSize" field in both headers.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_7">CSPSA_TC_7</h4>
<h5 id="_test_objective_7">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Test all API functions with bad input parameters
</p>
</li>
</ul></div>
<h5 id="_test_steps_7">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
CSPSA_Open()
</p>
</li>
<li>
<p>
CSPSA_Close()
</p>
</li>
<li>
<p>
CSPSA_GetSizeOfValue()
</p>
</li>
<li>
<p>
CSPSA_GetSizeOfNextValue()
</p>
</li>
<li>
<p>
CSPSA_ReadValue()
</p>
</li>
<li>
<p>
CSPSA_WriteValue()
</p>
</li>
<li>
<p>
CSPSA_DeleteValue()
</p>
</li>
<li>
<p>
CSPSA_Flush()
</p>
</li>
<li>
<p>
CSPSA_Format()
</p>
</li>
<li>
<p>
CSPSA_Create()
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_8">CSPSA_TC_8</h4>
<h5 id="_test_objective_8">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Increase and decrease the size of a CSPSA image significantly and verify it
</p>
</li>
<li>
<p>
All CSPSA function call durations should be summed up and presented as a test result
</p>
</li>
</ul></div>
<h5 id="_test_steps_8">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Add a large item after first flush.
</p>
</li>
<li>
<p>
Replace with a large item after first flush.
</p>
</li>
<li>
<p>
Add a large item before first flush.
</p>
</li>
<li>
<p>
Replace a large item before first flush.
</p>
</li>
<li>
<p>
Add and delete a large item before first flush.
</p>
</li>
<li>
<p>
Replace and delete a large item before first flush.
</p>
</li>
<li>
<p>
Replace and delete a large item before first flush.
</p>
</li>
<li>
<p>
Replace and delete a large item (with second Key value).
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_9">CSPSA_TC_9</h4>
<h5 id="_test_objective_9">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Increase and decrease the existing parameters small amounts
</p>
</li>
<li>
<p>
All CSPSA function call durations should be summed up and presented as a test result
</p>
</li>
</ul></div>
<h5 id="_test_steps_9">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Add a large item after first flush.
</p>
</li>
<li>
<p>
Replace with a large item after first flush.
</p>
</li>
<li>
<p>
Add a large item before first flush.
</p>
</li>
<li>
<p>
Replace a large item before first flush.
</p>
</li>
<li>
<p>
Add and delete a large item before first flush.
</p>
</li>
<li>
<p>
Replace and delete a large item before first flush.
</p>
</li>
<li>
<p>
Replace and delete a large item before first flush.
</p>
</li>
<li>
<p>
Replace and delete a large item (with second Key value).
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_10">CSPSA_TC_10</h4>
<h5 id="_test_objective_10">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Multiple clients test
</p>
</li>
</ul></div>
<h5 id="_test_steps_10">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Create CSPSA.
</p>
</li>
<li>
<p>
Start five threads of which three are reading and two are writing to the same CSPSA, and let threads run for &gt; 30 s.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_11">CSPSA_TC_11</h4>
<h5 id="_test_objective_11">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Performance test.
</p>
</li>
</ul></div>
<h5 id="_test_steps_11">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Create a CSPSA with 4096 items of 24 bytes each and measure time for each operation, except for the first flush operation.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_12">CSPSA_TC_12</h4>
<h5 id="_test_objective_12">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Make sure CSPSA can be opened when there are two valid headers
</p>
</li>
</ul></div>
<h5 id="_test_steps_12">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Both headers and data is valid.
</p>
</li>
<li>
<p>
Both headers are valid, but the latest written data has a bit error.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_13">CSPSA_TC_13</h4>
<h5 id="_test_objective_13">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Measure performance of reads and writes to storage media.
</p>
</li>
</ul></div>
<h5 id="_test_steps_13">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Write 8 x 128 kB.
</p>
</li>
<li>
<p>
Read 8 x 128 kB.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_14">CSPSA_TC_14</h4>
<h5 id="_test_objective_14">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Create a CSPSA and add a few values to it (useful initial test for testing plugin implementations)
</p>
</li>
</ul></div>
<h5 id="_test_steps_14">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Create a CSPSA.
</p>
</li>
<li>
<p>
Add some values and flush
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_15">CSPSA_TC_15</h4>
<h5 id="_test_objective_15">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Tests adding/deleting/flushing/reopening.
</p>
</li>
</ul></div>
<h5 id="_test_steps_15">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Create a CSPSA
</p>
</li>
<li>
<p>
Randomly adds/deletes values, or flushes/reopens. After every add/delete/reopen it is checked that the contents of the CSPSA are correct.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_16">CSPSA_TC_16</h4>
<h5 id="_test_objective_16">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Tests robustness against read errors, both the case where the underlying plugin detects the read error (i.e. is unable to read from the underlying media)
and the case where bits have become corrupt without being detected by the underlying plugin.
</p>
</li>
</ul></div>
<h5 id="_test_steps_16">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Create a CSPSA, adds some values and flushes the contents.
</p>
</li>
<li>
<p>
Opens the CSPSA, but while reading the contents, a (induced) read error occurs; it is checked that the open fails with appropriate error code.
   This is repeated for every block that has been written.
</p>
</li>
<li>
<p>
Opens the CSPSA, but while reading the contents, a (induced) bit error occurs; the CRC check should fail; it is checked that the open fails with appropriate error code.
   This is repeated once for every word that has been written to check that any bit error at any place is correctly detected.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_17">CSPSA_TC_17</h4>
<h5 id="_test_objective_17">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Check that image is stored alternating at beginning and end.
</p>
</li>
</ul></div>
<h5 id="_test_steps_17">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Write value and flush seven times and check that image is stored alternating at beginning and end.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_18">CSPSA_TC_18</h4>
<h5 id="_test_objective_18">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Create a certain sequence of items that could cause problems in function F_CSPSA_CORE_ImageArray_LoadData().
</p>
</li>
</ul></div>
<h5 id="_test_steps_18">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Write few values; key 1 and 2 will end up at very end of their block.
</p>
</li>
</ol></div>
<h4 id="_cspsa_tc_19">CSPSA_TC_19</h4>
<h5 id="_test_objective_19">Test objective</h5>
<div class="ulist"><ul>
<li>
<p>
Check that the fast parameter feature works.
</p>
</li>
</ul></div>
<h5 id="_test_steps_19">Test steps</h5>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Write different 32-bit values to the different fast parameters and check result.
</p>
</li>
<li>
<p>
Negative tests. Try writing an item with different size than 4 bytes, and try deleting
a fast parameter.
</p>
</li>
</ol></div>
<div id="footer">
<div id="footer-text">
Last updated 2010-09-14 14:03:02 CEST
</div>
</div>
</body>
</html>
